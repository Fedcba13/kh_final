<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="food">
	<select id="selectFoodDivisionList" resultType="foodDivision">
		SELECT *
		FROM FOOD_DIVISION
		ORDER BY FOOD_DIVISION_NAME
	</select>
	<select id="selectFoodUpperList" resultType="foodUpper">
		SELECT *
		FROM FOOD_UPPER
		ORDER BY FOOD_UPPER_NAME
	</select>
	<select id="selectMarketList" resultType="market">
		SELECT *
		FROM MARKET
		ORDER BY MARKET_NAME
	</select>
	<select id="selectFoodListByCat" resultType="FoodWithStockInMarket" parameterType="map">
		SELECT *
		FROM FOOD F LEFT JOIN FOOD_SECTION S ON F.FOOD_SECTION_NO = S.FOOD_SECTION_NO
					LEFT JOIN FOOD_UPPER U ON S.FOOD_UPPER_NO = U.FOOD_UPPER_NO
					LEFT JOIN FOOD_DIVISION D ON U.FOOD_DIVISION_NO = D.FOOD_DIVISION_NO
					LEFT JOIN STOCK T ON F.FOOD_NO = T.FOOD_NO
					LEFT JOIN MARKET M ON T.MARKET_NO = M.MARKET_NO 
		<trim prefix="WHERE" suffixOverrides="AND">
			M.MARKET_NO = #{marketNo} 
			<if test="FOOD_DIVISION_NO !=null and FOOD_DIVISION_NO !=''">
			AND D.FOOD_DIVISION_NO = #{FOOD_DIVISION_NO}
			</if>
			<if test="FOOD_UPPER_NO !=null and FOOD_UPPER_NO !=''">
			AND U.FOOD_UPPER_NO = #{FOOD_UPPER_NO}
			</if>
			<if test="FOOD_SECTION_NO !=null and FOOD_SECTION_NO !=''">
			AND S.FOOD_SECTION_NO = #{FOOD_SECTION_NO}
			</if>
			AND M.MARKET_ENABLED = 1 AND FLAG = 2
		</trim>
		
	</select>
	<select id="getSubUpperList" resultType="foodUpper">
		SELECT *
		FROM FOOD_UPPER
		WHERE FOOD_DIVISION_NO = #{searchNo}
		ORDER BY FOOD_UPPER_NAME
	</select>	
	<select id="getSubSectList" resultType="foodSection">
		SELECT *
		FROM FOOD_SECTION
		WHERE FOOD_UPPER_NO = #{searchNo}
		ORDER BY FOOD_SECTION_NAME
	</select>	
	<select id="getUpperNoBySectNo" resultType="string" >
		SELECT FOOD_UPPER_NO
		FROM FOOD_SECTION
		WHERE FOOD_SECTION_NO = #{searchNo}
	</select>
	<select id="selectBrotherSectList" resultType="foodSection">
		SELECT *
		FROM FOOD_SECTION
		WHERE FOOD_UPPER_NO = #{upperNo}
		ORDER BY FOOD_SECTION_NAME
	</select>
</mapper>